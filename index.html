<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×‘×•×˜ × ×™×ª×•×— ×ª×–×•× ×” - ×”×•×œ×˜×¨ ×¡×•×›×¨</title>
    <link href="https://fonts.googleapis.com/css2?family=Alef:wght@400;700&family=Assistant:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box; 
        }

        
        :root {
            --primary: #2d6a4f;
            --primary-dark: #1b4332;
            --secondary: #52b788;
            --accent: #f4a261;
            --danger: #e63946;
            --warning: #f4a460;
            --success: #52b788;
            --bg-main: #f8faf8;
            --bg-card: #ffffff;
            --text-primary: #1a1a1a;
            --text-secondary: #4a5568;
            --border: #d4d4d8;
            --shadow: rgba(0, 0, 0, 0.08);
            --gradient-start: #7BC043;
            --gradient-end: #95d158;
        }

        body {
            font-family: 'Assistant', sans-serif;
            background: linear-gradient(135deg, var(--gradient-start) 0%, var(--gradient-end) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 30px 20px 40px;
            background: var(--bg-card);
            border-radius: 20px;
            box-shadow: 0 10px 40px var(--shadow);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: #3498DB;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .logo {
            width: auto;
            height: 60px;
            object-fit: contain;
        }

        h1 {
            font-family: 'Alef', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0;
        }

        .brand-bite {
            color: #81b214;
        }

        .brand-balance {
            color: #4a90e2;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            font-weight: 300;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
        }

        .card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 5px 25px var(--shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.12);
        }

        .input-section {
            margin-bottom: 25px;
        }

        label {
            display: block;
            font-weight: 600;
            color: var(--primary-dark);
            margin-bottom: 10px;
            font-size: 1.05rem;
        }

        textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-family: 'Assistant', sans-serif;
            font-size: 1rem;
            resize: vertical;
            min-height: 120px;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(45, 106, 79, 0.1);
        }

        button {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
            padding: 16px 40px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(45, 106, 79, 0.3);
            width: 100%;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(45, 106, 79, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 30px;
            color: var(--primary);
        }

        .loading.active {
            display: block;
        }

        .spinner {
            width: 80px;
            height: 80px;
            border: 8px solid transparent;
            border-top: 8px solid #81b214;
            border-right: 8px solid #4a90e2;
            border-radius: 50%;
            animation: spin 1.2s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-container {
            text-align: center;
            padding: 40px 20px;
        }

        .loading-text {
            color: var(--text-secondary);
            font-size: 1.15rem;
            margin-top: 10px;
            font-weight: 500;
        }

        .results {
            display: none;
        }

        .results.active {
            display: block;
        }

        .score-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            font-size: 1.8rem;
            font-weight: 800;
            padding: 15px 25px;
            border-radius: 12px;
            margin: 20px 0;
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
        }

        .recommendation {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--primary-dark);
            margin: 15px 0;
            padding: 15px;
            background: rgba(82, 183, 136, 0.1);
            border-right: 4px solid var(--secondary);
            border-radius: 8px;
        }

        .details-section {
            margin-top: 25px;
            padding: 20px;
            background: var(--bg-main);
            border-radius: 12px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border);
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-weight: 600;
            color: var(--text-secondary);
        }

        .detail-value {
            font-weight: 700;
            color: var(--primary-dark);
        }

        .next-meal-section {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #fff8dc 0%, #ffe4b5 100%);
            border-radius: 12px;
            border: 2px solid var(--accent);
        }

        .next-meal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-dark);
            margin-bottom: 15px;
        }

        .substitutes {
            margin-top: 20px;
            padding: 20px;
            background: #f0f9ff;
            border-radius: 12px;
            border-right: 4px solid #0ea5e9;
        }

        .substitute-item {
            padding: 10px 0;
            font-size: 1.05rem;
        }

        .meal-history {
            margin-top: 20px;
        }

        .meal-card {
            background: var(--bg-main);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-right: 4px solid var(--secondary);
        }

        .meal-card h4 {
            color: var(--primary-dark);
            margin-bottom: 8px;
        }

        .emoji-large {
            font-size: 2rem;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .card {
                padding: 20px;
            }

            button {
                padding: 14px 30px;
            }
        }

        .error-message {
            background: #fee;
            border: 2px solid var(--danger);
            color: var(--danger);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            display: none;
        }

        .error-message.active {
            display: block;
        }

        .show-details-btn {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            margin-top: 15px;
            padding: 12px 30px;
            font-size: 1rem;
        }

        .detailed-nutrition {
            display: none;
            margin-top: 20px;
            animation: fadeIn 0.3s ease;
        }

        .detailed-nutrition.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .recipe-section {
            margin-top: 25px;
            padding: 25px;
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-radius: 12px;
            border: 2px solid #f59e0b;
        }

        .recipe-button {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            margin-top: 10px;
        }

        .input-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 2px solid var(--border);
        }

        .tab-btn {
            background: transparent;
            color: var(--text-secondary);
            border: none;
            padding: 12px 24px;
            font-size: 1.05rem;
            font-weight: 600;
            cursor: pointer;
            border-radius: 0;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            width: auto;
            box-shadow: none;
        }

        .tab-btn:hover {
            color: #7BC043;
            background: rgba(123, 192, 67, 0.05);
            transform: none;
        }

        .tab-btn.active {
            color: #7BC043;
            border-bottom-color: #7BC043;
            background: transparent;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .image-upload-area {
            border: 3px dashed var(--border);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            background: var(--bg-main);
        }

        .image-upload-area:hover {
            border-color: var(--primary);
            background: rgba(45, 106, 79, 0.05);
        }

        .upload-placeholder {
            color: var(--text-secondary);
        }

        .upload-icon {
            margin-bottom: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .upload-icon img {
            width: 60px;
            height: 60px;
        }

        .image-preview {
            position: relative;
            max-width: 500px;
            margin: 0 auto;
        }

        .image-preview img {
            width: 100%;
            border-radius: 12px;
            box-shadow: 0 5px 25px var(--shadow);
        }

        .remove-image-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--danger);
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s ease;
        }

        .remove-image-btn:hover {
            transform: scale(1.1);
        }

        .auto-description {
            margin-top: 25px;
        }

        .edit-analysis-section {
            margin-top: 20px;
            padding: 20px;
            background: #fff8dc;
            border-radius: 12px;
            border: 2px solid var(--accent);
        }

        .edit-analysis-section h4 {
            color: var(--primary-dark);
            margin-bottom: 15px;
        }

        .editable-field {
            margin-bottom: 15px;
        }

        .editable-field label {
            display: block;
            font-size: 0.95rem;
            margin-bottom: 5px;
            color: var(--text-secondary);
        }

        .editable-field input,
        .editable-field textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-family: 'Assistant', sans-serif;
        }

        .editable-field input {
            font-size: 1rem;
        }

        .save-edits-btn {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            margin-top: 10px;
        }

        .reasoning-box {
            margin: 20px 0;
            padding: 15px 20px;
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-radius: 10px;
            border-right: 4px solid #f59e0b;
            font-size: 1.05rem;
            line-height: 1.7;
            color: #78350f;
        }

        .star-rating {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin: 25px 0;
        }

        .star {
            font-size: 3rem;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .star:hover {
            transform: scale(1.2);
        }

        .star.filled {
            color: #fbbf24;
            text-shadow: 0 2px 8px rgba(251, 191, 36, 0.4);
        }

        .star.empty {
            color: #d1d5db;
        }

        .rating-score {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary-dark);
            margin-right: 15px;
        }

        .details-toggle-section {
            display: none;
            animation: slideDown 0.3s ease;
        }

        .details-toggle-section.active {
            display: block;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .toggle-btn {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            margin-top: 20px;
            width: calc(50% - 10px);
            display: inline-block;
        }

        .toggle-btn:first-of-type {
            margin-left: 10px;
        }

        .toggle-btn:last-of-type {
            margin-right: 10px;
        }

        .toggle-buttons-container {
            display: flex;
            gap: 20px;
            margin-top: 25px;
        }

        .close-section-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            z-index: 10;
        }

        .close-section-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .section-with-close {
            position: relative;
            padding-top: 60px;
        }

        .next-meal-toggle-section {
            display: none;
            animation: slideDown 0.3s ease;
        }

        .next-meal-toggle-section.active {
            display: block;
        }

        .score-description {
            text-align: center;
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-top: 10px;
        }

        .meal-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .meal-option-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 2px solid transparent;
        }

        .meal-option-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.15);
        }

        .meal-option-card.vegetarian {
            border-color: #10b981;
        }

        .meal-option-card.meat {
            border-color: #ef4444;
        }

        .meal-option-card.fish {
            border-color: #3b82f6;
        }

        .meal-option-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            font-size: 1.3rem;
            font-weight: 700;
        }

        .meal-option-card.vegetarian .meal-option-header {
            color: #059669;
        }

        .meal-option-card.meat .meal-option-header {
            color: #dc2626;
        }

        .meal-option-card.fish .meal-option-header {
            color: #2563eb;
        }

        .meal-option-description {
            font-size: 1.05rem;
            line-height: 1.6;
            color: var(--text-primary);
            margin-bottom: 15px;
            min-height: 60px;
        }

        .meal-option-btn {
            width: 100%;
            padding: 12px 20px;
            font-size: 1rem;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            margin-top: 10px;
        }

        .meal-option-card.vegetarian .meal-option-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .meal-option-card.meat .meal-option-btn {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        .meal-option-card.fish .meal-option-btn {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <img src="data:image/png;base64,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" alt="BiteBalance Logo" class="logo">
                <h1><span class="brand-bite">Bite</span><span class="brand-balance">Balance</span></h1>
            </div>
            <p class="subtitle">× ×ª×— ××ª ×”××¨×•×—×” ×©×œ×š ×•×§×‘×œ ×”××œ×¦×•×ª ××•×ª×××•×ª ××™×©×™×ª</p>
        </header>

        <div class="main-content">
            <div class="card">
                <div class="input-tabs">
                    <button class="tab-btn active" onclick="switchTab('image')">
                        <img src="data:image/png;base64,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" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 8px;">
                        ×”×¢×œ××ª ×ª××•× ×”
                    </button>
                    <button class="tab-btn" onclick="switchTab('text')">
                        <img src="data:image/png;base64,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" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 8px;">
                        ×ª×™××•×¨ ×”××¨×•×—×”
                    </button>
                </div>

                <div class="tab-content active" id="imageTab">
                    <div class="input-section">
                        <label for="imageInput">×”×¢×œ×” ×ª××•× ×” ×©×œ ×”××¨×•×—×”:</label>
                        <div class="image-upload-area" id="uploadArea">
                            <input 
                                type="file" 
                                id="imageInput" 
                                accept="image/*" 
                                style="display: none;"
                                onchange="handleImageSelect(event)"
                            >
                            <div class="upload-placeholder" onclick="document.getElementById('imageInput').click()">
                                <div class="upload-icon">
                                    <img src="data:image/png;base64,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" style="width: 60px; height: 60px;">
                                </div>
                                <p>×œ×—×¥ ×œ×”×¢×œ××ª ×ª××•× ×”</p>
                                <p style="font-size: 0.9rem; color: var(--text-secondary);">××• ×’×¨×•×¨ ×ª××•× ×” ×œ×›××Ÿ</p>
                            </div>
                            <div class="image-preview" id="imagePreview" style="display: none;">
                                <img id="previewImg" src="" alt="×ª×¦×•×’×” ××§×“×™××”">
                                <button class="remove-image-btn" onclick="removeImage()">âœ•</button>
                            </div>
                        </div>
                        <div class="auto-description" id="autoDescription" style="display: none;">
                            <label>×ª×™××•×¨ ××•×˜×•××˜×™ ×©×œ ×”××¨×•×—×”:</label>
                            <textarea 
                                id="autoDescriptionText" 
                                placeholder="×”×‘×•×˜ ×™×–×”×” ××ª ×”××¨×•×—×” ××”×ª××•× ×”..."
                                style="background: #f0f9ff;"
                            ></textarea>
                            <p style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 8px;">
                                âœï¸ × ×™×ª×Ÿ ×œ×¢×¨×•×š ××ª ×”×ª×™××•×¨ ×œ×¤× ×™ ×”× ×™×ª×•×—
                            </p>
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="textTab">
                    <div class="input-section">
                        <label for="mealInput">×ª××¨ ××ª ×”××¨×•×—×” ×©××›×œ×ª:</label>
                        <textarea 
                            id="mealInput" 
                            placeholder="×œ×“×•×’××: 150 ×’×¨× ×—×–×” ×¢×•×£, 100 ×’×¨× ××•×¨×–, ×¡×œ×˜ ×¢×’×‘× ×™×•×ª ×•××œ×¤×¤×•× ×™× ××ª×•×‘×œ ×‘×©××Ÿ ×–×™×ª"
                        ></textarea>
                    </div>
                </div>
                
                <button id="analyzeBtn" onclick="analyzeMeal()">
                    ğŸ” × ×ª×— ××¨×•×—×”
                </button>

                <div class="error-message" id="errorMessage"></div>
            </div>

            <div class="loading" id="loadingDiv">
                <div class="loading-container">
                    <div class="spinner"></div>
                    <p class="loading-text">×× ×ª×— ××ª ×”××¨×•×—×” ×©×œ×š...</p>
                </div>
            </div>

            <div class="results" id="resultsDiv">
                <div class="card">
                    <h2 style="color: var(--primary-dark); margin-bottom: 20px;">ğŸ“Š ×ª×•×¦××•×ª ×”× ×™×ª×•×—</h2>
                    
                    <!-- Star Rating -->
                    <div id="starRatingSection"></div>
                    
                    <!-- Collapsible Details Section -->
                    <div class="details-toggle-section section-with-close" id="detailsToggleSection">
                        <button class="close-section-btn" onclick="toggleDetailsSection()">
                            â† ×”×¡×ª×¨ × ×™×ª×•×— ××œ×
                        </button>
                        
                        <div id="analysisResults"></div>
                        
                        <div class="edit-analysis-section" id="editSection" style="display: none;">
                            <h4>âœï¸ ×¢×¨×™×›×ª ×”× ×™×ª×•×—</h4>
                            <div class="editable-field">
                                <label>×“×™×¨×•×’ (0-100):</label>
                                <input type="number" id="editScore" min="0" max="100" />
                            </div>
                            <div class="editable-field">
                                <label>×”××œ×¦×” (Always âœ… / Sometimes âš–ï¸ / Never âŒ):</label>
                                <select id="editRecommendation" style="width: 100%; padding: 10px; border-radius: 8px;">
                                    <option value="Always âœ…">Always âœ…</option>
                                    <option value="Sometimes âš–ï¸">Sometimes âš–ï¸</option>
                                    <option value="Never âŒ">Never âŒ</option>
                                </select>
                            </div>
                            <div class="editable-field">
                                <label>×¡×™×‘×ª ×”×“×™×¨×•×’:</label>
                                <textarea id="editReason" rows="4"></textarea>
                            </div>
                            <div class="editable-field">
                                <label>×¢×•××¡ ×’×œ×™×§××™:</label>
                                <select id="editGlycemic" style="width: 100%; padding: 10px; border-radius: 8px;">
                                    <option value="âœ… × ××•×š">âœ… × ××•×š</option>
                                    <option value="âš ï¸ ×‘×™× ×•× ×™">âš ï¸ ×‘×™× ×•× ×™</option>
                                    <option value="ğŸš« ×’×‘×•×”">ğŸš« ×’×‘×•×”</option>
                                </select>
                            </div>
                            <button class="save-edits-btn" onclick="saveEdits()">
                                ğŸ’¾ ×©××•×¨ ×©×™× ×•×™×™×
                            </button>
                            <button class="show-details-btn" onclick="cancelEdit()" style="background: #6b7280;">
                                âŒ ×‘×™×˜×•×œ
                            </button>
                        </div>
                        
                        <button class="show-details-btn" id="editBtn" onclick="toggleEditMode()" style="display: none;">
                            âœï¸ ×¢×¨×•×š × ×™×ª×•×—
                        </button>
                        
                        <button class="show-details-btn" onclick="toggleNutritionDetails()">
                            ğŸ“‹ ×”×¦×’ ×¤×¨×˜×™× ×ª×–×•× ×ª×™×™× ××œ××™×
                        </button>
                        
                        <div class="detailed-nutrition" id="detailedNutrition"></div>
                    </div>
                    
                    <div class="toggle-buttons-container">
                        <button class="toggle-btn" id="toggleDetailsBtn" onclick="toggleDetailsSection()" style="display: none;">
                            ğŸ‘ï¸ ×œ××” ×‘×¢×™×™×ª×™? ×”×¦×’ × ×™×ª×•×— ××œ×
                        </button>
                        
                        <button class="toggle-btn" id="toggleNextMealBtn" onclick="toggleNextMealSection()" style="display: none;">
                            ğŸ½ï¸ ×”×¦×’ ×”××œ×¦×•×ª ×œ××¨×•×—×” ×”×‘××”
                        </button>
                    </div>
                    
                    <!-- Collapsible Next Meal Section -->
                    <div class="next-meal-toggle-section section-with-close" id="nextMealToggleSection">
                        <button class="close-section-btn" onclick="toggleNextMealSection()">
                            â†‘ ×”×¡×ª×¨ ×”××œ×¦×•×ª
                        </button>
                        
                        <div class="next-meal-section">
                            <h3 class="next-meal-title">ğŸ½ï¸ ×”××œ×¦×•×ª ×œ××¨×•×—×” ×”×‘××”</h3>
                            <div id="reasoningBox"></div>
                            <div id="mealOptions" class="meal-options"></div>
                            <div id="nextMealSuggestion"></div>
                        </div>
                    </div>
                    
                    <!-- Summary - Always Open -->
                    <div id="summarySection" style="margin-top: 25px;"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const NUTRITION_GUIDELINES = `
# ×§×•×•×™× ×× ×—×™× ×ª×–×•× ×ª×™×™× - ×”×•×œ×˜×¨ ×¡×•×›×¨ (×©×‘×•×¢ ×©× ×™)

## ××–×•× ×•×ª ××•××œ×¦×™×:
- ×ª×—×œ×™×¤×™ ×—×œ×‘: ×—×œ×‘ ×¡×•×™×” ×œ×œ× ×¡×•×›×¨, ×—×œ×‘ ×©×§×“×™× ×œ×œ× ×¡×•×›×¨
- ××’×•×–×™× ×œ× ×§×œ×•×™×™×: ××’×•×–×™ ××œ×š, ×©×§×“×™×, ×¤×§××Ÿ, ×œ×•×–, ×§×©×™×•, ×¤×™×¡×˜×•×§, ××§×“××™×”, ×‘×¨×–×™×œ
- ×§××—×™×: ×›×•×¡××™×Ÿ ××œ×, ×©×™×¤×•×Ÿ ××œ×, ×§××— ×©×§×“×™×, ×§××— ×¢×“×©×™×, ×§××— ×›×•×¡××ª ×™×¨×•×§×”
- ××•×¨×–: ××œ×, ××“×•×, ×©×—×•×¨ (wild rice)
- ×œ×—×: ×©×§×“×™×, ×¤×©×ª×Ÿ, ×˜×—×™× ×”, ×›×•×¡××™×Ÿ ××œ×, ×©×™×¤×•×Ÿ ××œ×
- ×××ª×™×§×™×: ×ª××¦×™×ª ×¡×˜×™×‘×™×” × ×•×–×œ×™×ª ×‘×œ×‘×“
- ×©×•×§×•×œ×“: ××¨×™×¨ 70% ×•××¢×œ×”
- ×©×× ×™×: ×©××Ÿ ×–×™×ª, ×—×××ª ×’×”×™
- ×™×¨×§×•×ª: ×›×œ ×”×™×¨×§×•×ª ××•×ª×¨×™× (×¤×˜×¨×™×•×ª, ××œ×¤×¤×•×Ÿ, ×—×¡×”, ×¢×’×‘× ×™×•×ª, × ×‘×˜×™×, ×ª×¨×“, ×©×¢×•×¢×™×ª ×™×¨×•×§×”/×¦×”×•×‘×”, ×§×™×©×•××™×, ×–×•×§×™× ×™, ×‘×¦×œ, ×’××‘×”, ××¨×˜×™×©×•×§ ×™×¨×•×©×œ××™, ×¡×œ×§, ×¦× ×•×Ÿ, ×§×™×™×œ, ×¡×œ×¨×™, ×’×–×¨, ×“×œ×•×¨×™×ª, ×“×œ×¢×ª, ×—×¦×™×œ, ×›×¨×•×‘, ×›×¨×•×‘×™×ª, ×‘×¨×•×§×•×œ×™)
- ×¤×™×¨×•×ª (×¢×“ 2 ×× ×•×ª ×‘×™×•×): ×ª×¤×•×—, ××’×¡, ×—×¦×™ ×¤×•××œ×”, ×’×•×™××‘×”, ×¤×™×¨×•×ª ×™×¢×¨, ×ª×•×ª ×©×“×”, ××©××©, ×©×–×™×£, ×›×•×¡ ××œ×•×Ÿ, ×›×•×¡ ××‘×˜×™×—
- ×§×˜× ×™×•×ª: ×××©, ×¤×•×œ×™ ××–×•×§×™, ×’×¨×’×¨×™ ×—×•××•×¡, ×¢×“×©×™× (×›×œ ×”×¦×‘×¢×™×), ××“×××”, ××¤×•× ×”
- ×—×œ×‘×•× ×™×: ×‘×™×¦×™×, ×“×’×™×, ×¢×•×£, ×”×•×“×•, ×‘×©×¨
- ×¨×˜×‘×™× ×ª×•×¦×¨×ª ×‘×™×ª: ××™×•×œ×™, ×¤×¡×˜×•, ×˜×—×™× ×”, ×˜×—×™× ×” ×™×¨×•×§×”, ×•×™× ×™×’×¨×˜, ×¦'×™××™×¦'×•×¨×™

## ××–×•× ×•×ª ××¡×•×¨×™× ×œ×—×œ×•×˜×™×Ÿ:
- ××•×¦×¨×™ ×—×œ×‘ (×—×œ×‘ ×¨×’×™×œ, ×’×‘×™× ×•×ª, ×™×•×’×•×¨×˜ ×¨×’×™×œ, ×©×× ×ª)
- ×©×•××Ÿ ×˜×¨× ×¡: ×××¤×™× ×ª×¢×©×™×™×ª×™×™×, ×¢×•×’×•×ª, ×¢×•×’×™×•×ª, ×‘×•×¨×§×¡×™×, ×•×•×¤×œ×™×, ×¤×™×¦×•×ª ×§×¤×•××•×ª
- ×—×˜×™×¤×™× ××œ×•×—×™×: ×‘××‘×”, ×‘×™×™×’×œ×”, ×¦'×™×¤×¡
- ××–×•×Ÿ ××˜×•×’×Ÿ: ×©× ×™×¦×œ×™× ××˜×•×’× ×™×, ×¤× ×§×™×™×§ ××˜×•×’×Ÿ
- ××¨×’×¨×™× ×” ×•××•×¦×¨×™×”
- ×’×œ×™×“×” ×ª×¢×©×™×™×ª×™×ª
- ×©×•×§×•×œ×“ ×—×œ×‘ ××• ×¤×¨×•×•×”
- ×¡×•×›×¨ ×•××•×¦×¨×™× ×××•×ª×§×™× (××œ×‘×“ ×¡×˜×™×‘×™×”)

## ×›×œ×œ×™× ×—×©×•×‘×™×:
- ×¡×™×•× ××›×™×œ×” 3 ×©×¢×•×ª ×œ×¤× ×™ ×©×™× ×”
- 2-3 ×œ×™×˜×¨ ××™× ×‘×™×•×
- ××¨×•×—×•×ª ××¡×•×“×¨×•×ª
- ×”×™×× ×¢×•×ª ××©×× ×™× ××¢×•×‘×“×™× (×§× ×•×œ×”, ×¡×•×™×”, ×—×× ×™×•×ª)
`;

        let currentMealData = null;
        let currentImageBase64 = null;
        let currentTab = 'image';
        let editableData = {};
        let mealOptions = {
            vegetarian: '',
            meat: '',
            fish: ''
        };

        function switchTab(tab) {
            currentTab = tab;
            
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            if (tab === 'text') {
                document.getElementById('textTab').classList.add('active');
                // Enable analyze button for text tab
                document.getElementById('analyzeBtn').disabled = false;
            } else {
                document.getElementById('imageTab').classList.add('active');
                // Keep button disabled until image is uploaded and recognized
            }
        }

        function handleImageSelect(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (!file.type.startsWith('image/')) {
                showError('×× × ×‘×—×¨ ×§×•×‘×¥ ×ª××•× ×” ×ª×§×™×Ÿ');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = async function(e) {
                currentImageBase64 = e.target.result.split(',')[1];
                
                // Show preview
                document.getElementById('previewImg').src = e.target.result;
                document.querySelector('.upload-placeholder').style.display = 'none';
                document.getElementById('imagePreview').style.display = 'block';
                
                // Analyze image
                await analyzeImage();
            };
            reader.readAsDataURL(file);
        }

        function removeImage() {
            currentImageBase64 = null;
            document.getElementById('imageInput').value = '';
            document.querySelector('.upload-placeholder').style.display = 'block';
            document.getElementById('imagePreview').style.display = 'none';
            document.getElementById('autoDescription').style.display = 'none';
            document.getElementById('autoDescriptionText').value = '';
        }

        async function analyzeImage() {
            const autoDescDiv = document.getElementById('autoDescription');
            const autoDescText = document.getElementById('autoDescriptionText');
            const analyzeBtn = document.getElementById('analyzeBtn');
            
            autoDescDiv.style.display = 'block';
            autoDescText.value = '××–×”×” ××ª ×”××¨×•×—×”...';
            autoDescText.disabled = true;
            analyzeBtn.disabled = true; // Disable analyze button during recognition
            
            try {
                // Call our serverless API for image recognition
                const response = await fetch('/api/recognize', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        imageBase64: currentImageBase64
                    })
                });

                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || '×©×’×™××” ×‘×–×™×”×•×™ ×”×ª××•× ×”');
                }
                
                autoDescText.value = data.description;
                autoDescText.disabled = false;
                analyzeBtn.disabled = false; // Enable analyze button after description is ready
                
            } catch (error) {
                console.error('Error:', error);
                autoDescText.value = '×©×’×™××” ×‘×–×™×”×•×™ ×”×ª××•× ×”. ×× × ×ª××¨ ××ª ×”××¨×•×—×” ×™×“× ×™×ª.';
                autoDescText.disabled = false;
                analyzeBtn.disabled = false; // Enable button even on error so user can proceed
            }
        }

        // Drag and drop functionality
        const uploadArea = document.getElementById('uploadArea');
        
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.style.borderColor = 'var(--primary)';
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.style.borderColor = 'var(--border)';
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.style.borderColor = 'var(--border)';
            
            const file = e.dataTransfer.files[0];
            if (file && file.type.startsWith('image/')) {
                document.getElementById('imageInput').files = e.dataTransfer.files;
                handleImageSelect({ target: { files: e.dataTransfer.files } });
            }
        });

        async function analyzeMeal() {
            let mealInput;
            
            if (currentTab === 'text') {
                mealInput = document.getElementById('mealInput').value.trim();
            } else {
                mealInput = document.getElementById('autoDescriptionText').value.trim();
            }
            
            if (!mealInput) {
                showError('×× × ×ª××¨ ××ª ×”××¨×•×—×” ××• ×”×¢×œ×” ×ª××•× ×”');
                return;
            }

            hideError();
            showLoading();
            hideResults();

            try {
                // Call our serverless API instead of directly calling Anthropic
                const response = await fetch('/api/analyze', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        mealDescription: mealInput
                    })
                });

                if (!response.ok) {
                    throw new Error('×©×’×™××” ×‘×§×‘×œ×ª ×ª×©×•×‘×” ××”×©×¨×ª');
                }

                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || '×©×’×™××” ×‘× ×™×ª×•×— ×”××¨×•×—×”');
                }
                
                currentMealData = {
                    meal: mealInput,
                    analysis: data.analysis
                };

                displayResults(data.analysis);
                hideLoading();
                showResults();
                document.getElementById('editBtn').style.display = 'block';

            } catch (error) {
                console.error('Error:', error);
                hideLoading();
                
                // Check if running outside Claude.ai
                if (error.message && error.message.includes('Failed to fetch')) {
                    showError('âš ï¸ ×”××¤×œ×™×§×¦×™×” ×”×–×• ×¤×•×¢×œ×ª ×¨×§ ×‘×ª×•×š Claude.ai\n\n×›×“×™ ×œ×”×©×ª××© ×‘××¤×œ×™×§×¦×™×”:\n1. ×¤×ª×— ××ª claude.ai ×‘×“×¤×“×¤×Ÿ\n2. ×”×¢×œ×” ××ª ×”×§×•×‘×¥ ×”×–×” ×›-Artifact\n3. ×”××¤×œ×™×§×¦×™×” ×ª×¢×‘×•×“ ×‘×¦×•×¨×” ××œ××”\n\n×œ× × ×™×ª×Ÿ ×œ×”×©×ª××© ×‘××¤×œ×™×§×¦×™×” ×›×§×•×‘×¥ ×¢×¦×××™ ×©×”×•×¨×“ ×œ××—×©×‘.');
                } else {
                    showError('××™×¨×¢×” ×©×’×™××” ×‘× ×™×ª×•×— ×”××¨×•×—×”. ×× × × ×¡×” ×©× ×™×ª.');
                }
            }
        }

        function displayResults(analysisText) {
            const resultsDiv = document.getElementById('analysisResults');
            const summarySection = document.getElementById('summarySection');
            
            // Reset sections
            document.getElementById('nextMealSuggestion').innerHTML = '';
            document.getElementById('reasoningBox').innerHTML = '';
            document.getElementById('mealOptions').innerHTML = '';
            summarySection.innerHTML = '';
            mealOptions = { vegetarian: '', meat: '', fish: '' };
            
            // Parse the analysis
            const lines = analysisText.split('\n');
            let html = '<div>';
            let substitutesHtml = '';
            let summaryHtml = '';
            let reasoningText = '';
            let scoreValue = 0;
            let scoreDescription = '';
            
            // Extract data for editing
            editableData = {
                score: '',
                recommendation: '',
                reason: '',
                glycemic: ''
            };
            
            // Find key sections
            let currentSection = '';
            lines.forEach(line => {
                line = line.trim();
                if (!line) return;
                
                if (line.includes('×“×™×¨×•×’ ×›×œ×œ×™') || line.includes('ğŸ’«') || line.includes('â­')) {
                    const scoreMatch = line.match(/(\d+)%/);
                    if (scoreMatch) {
                        editableData.score = scoreMatch[1];
                        scoreValue = parseInt(scoreMatch[1]);
                    }
                    // Extract description after the percentage
                    const descMatch = line.match(/\d+%\s*-\s*(.+)/);
                    if (descMatch) {
                        scoreDescription = descMatch[1];
                    }
                } else if (line.includes('×”×× ×›×“××™ ×œ××›×•×œ')) {
                    if (line.includes('Always')) editableData.recommendation = 'Always âœ…';
                    else if (line.includes('Sometimes')) editableData.recommendation = 'Sometimes âš–ï¸';
                    else if (line.includes('Never')) editableData.recommendation = 'Never âŒ';
                    html += `<div class="recommendation">${line.replace(/^\d+\.\s*/, '')}</div>`;
                } else if (line.includes('×¡×™×‘×ª ×”×“×™×¨×•×’')) {
                    currentSection = 'reason';
                } else if (line.includes('×¢×•××¡ ×’×œ×™×§××™')) {
                    if (line.includes('× ××•×š')) editableData.glycemic = 'âœ… × ××•×š';
                    else if (line.includes('×‘×™× ×•× ×™')) editableData.glycemic = 'âš ï¸ ×‘×™× ×•× ×™';
                    else if (line.includes('×’×‘×•×”')) editableData.glycemic = 'ğŸš« ×’×‘×•×”';
                } else if (line.includes('× ×™××•×§ ×œ××¨×•×—×” ×”×‘××”')) {
                    currentSection = 'reasoning';
                } else if (line.includes('×”××œ×¦×•×ª ×œ××¨×•×—×” ×”×‘××”')) {
                    currentSection = 'mealOptions';
                } else if (line.includes('×¡×™×›×•× ×•×”××œ×¦×•×ª')) {
                    currentSection = 'summary';
                    summaryHtml = '<div style="padding: 20px; background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%); border-radius: 12px; border: 2px solid #0ea5e9;"><h4 style="margin-bottom: 15px; color: #0c4a6e;">ğŸ’¡ ×¡×™×›×•× ×•×”××œ×¦×•×ª</h4>';
                } else if (line.includes('×ª×—×œ×™×¤×™×')) {
                    currentSection = 'substitutes';
                    if (!substitutesHtml) {
                        substitutesHtml = '<div class="substitutes"><h4 style="margin-bottom: 10px; color: #0369a1;">ğŸ”„ ×ª×—×œ×™×¤×™× ××•××œ×¦×™×:</h4>';
                    }
                } else if (line.includes('×¤×¨××˜×¨×™×') || line.includes('× ×•×˜×¨×™×× ×˜×™×')) {
                    currentSection = 'details';
                } else if (currentSection === 'reason' && !line.match(/^\d+\./)) {
                    editableData.reason = line;
                    currentSection = '';
                } else if (currentSection === 'reasoning') {
                    if (!line.match(/^\d+\./) && !line.includes('×”××œ×¦×•×ª')) {
                        reasoningText += line + ' ';
                    }
                } else if (currentSection === 'mealOptions') {
                    if (line.includes('××•×¤×¦×™×” ×¦××—×•× ×™×ª') || line.includes('×¦××—×•× ×™')) {
                        const mealText = line.replace(/^-\s*/, '').replace(/××•×¤×¦×™×” ×¦××—×•× ×™×ª:\s*/i, '');
                        mealOptions.vegetarian = mealText;
                    } else if (line.includes('××•×¤×¦×™×” ×‘×©×¨×™×ª') || line.includes('×‘×©×¨×™')) {
                        const mealText = line.replace(/^-\s*/, '').replace(/××•×¤×¦×™×” ×‘×©×¨×™×ª:\s*/i, '');
                        mealOptions.meat = mealText;
                    } else if (line.includes('××•×¤×¦×™×” ×“×’×™×') || line.includes('×“×’×™×')) {
                        const mealText = line.replace(/^-\s*/, '').replace(/××•×¤×¦×™×” ×“×’×™×:\s*/i, '');
                        mealOptions.fish = mealText;
                    }
                } else if (currentSection === 'summary') {
                    if (!line.match(/^\d+\./)) {
                        summaryHtml += `<p style="margin: 8px 0; font-size: 1.05rem; line-height: 1.7;">${line.replace(/^-\s*/, 'â€¢ ')}</p>`;
                    }
                } else if (currentSection === 'substitutes') {
                    if (line.match(/^-\s*/)) {
                        substitutesHtml += `<div class="substitute-item">${line.replace(/^-\s*/, 'â€¢ ')}</div>`;
                    }
                } else if (currentSection === 'details') {
                    // Store for detailed view
                } else {
                    html += `<p style="margin: 10px 0; font-size: 1.05rem; line-height: 1.6;">${line.replace(/^\d+\.\s*/, '')}</p>`;
                }
            });
            
            // Close sections
            if (substitutesHtml) {
                substitutesHtml += '</div>';
                html += substitutesHtml;
            }
            
            html += '</div>';
            resultsDiv.innerHTML = html;
            
            // Display star rating
            displayStarRating(scoreValue, scoreDescription);
            
            // Display reasoning
            if (reasoningText.trim()) {
                document.getElementById('reasoningBox').innerHTML = `<div class="reasoning-box">ğŸ’­ <strong>×œ××” ×‘×—×¨× ×• ××ª ×”×”××œ×¦×•×ª ×”×œ×œ×•:</strong> ${reasoningText}</div>`;
            }
            
            // Display meal options
            displayMealOptions();
            
            // Add summary (always visible)
            if (summaryHtml) {
                summaryHtml += '</div>';
                summarySection.innerHTML = summaryHtml;
            }
            
            // Show toggle buttons
            document.getElementById('toggleDetailsBtn').style.display = 'block';
            document.getElementById('toggleNextMealBtn').style.display = 'block';
            
            // Populate edit fields
            document.getElementById('editScore').value = editableData.score;
            document.getElementById('editRecommendation').value = editableData.recommendation;
            document.getElementById('editReason').value = editableData.reason;
            document.getElementById('editGlycemic').value = editableData.glycemic;
            
            // Store full analysis for detailed view
            storeDetailedNutrition(analysisText);
        }

        function displayStarRating(score, description) {
            const starSection = document.getElementById('starRatingSection');
            const filledStars = Math.round(score / 20); // Convert 0-100 to 0-5 stars
            const emptyStars = 5 - filledStars;
            
            let starsHtml = '<div class="star-rating">';
            starsHtml += `<span class="rating-score">${score}%</span>`;
            
            // Filled stars
            for (let i = 0; i < filledStars; i++) {
                starsHtml += '<span class="star filled">â˜…</span>';
            }
            
            // Empty stars
            for (let i = 0; i < emptyStars; i++) {
                starsHtml += '<span class="star empty">â˜…</span>';
            }
            
            starsHtml += '</div>';
            
            if (description) {
                starsHtml += `<div class="score-description">${description}</div>`;
            }
            
            starSection.innerHTML = starsHtml;
        }

        function toggleDetailsSection() {
            const section = document.getElementById('detailsToggleSection');
            const btn = document.getElementById('toggleDetailsBtn');
            
            if (section.classList.contains('active')) {
                section.classList.remove('active');
                btn.textContent = 'ğŸ‘ï¸ ×œ××” ×‘×¢×™×™×ª×™? ×”×¦×’ × ×™×ª×•×— ××œ×';
            } else {
                section.classList.add('active');
                btn.textContent = 'ğŸ”¼ ×”×¡×ª×¨ × ×™×ª×•×— ××œ×';
            }
        }

        function toggleNextMealSection() {
            const section = document.getElementById('nextMealToggleSection');
            const btn = document.getElementById('toggleNextMealBtn');
            
            if (section.classList.contains('active')) {
                section.classList.remove('active');
                btn.textContent = 'ğŸ½ï¸ ×”×¦×’ ×”××œ×¦×•×ª ×œ××¨×•×—×” ×”×‘××”';
            } else {
                section.classList.add('active');
                btn.textContent = 'ğŸ”¼ ×”×¡×ª×¨ ×”××œ×¦×•×ª ×œ××¨×•×—×” ×”×‘××”';
            }
        }

        function displayMealOptions() {
            const optionsContainer = document.getElementById('mealOptions');
            let html = '';
            
            if (mealOptions.vegetarian) {
                html += `
                    <div class="meal-option-card vegetarian">
                        <div class="meal-option-header">
                            ğŸŒ± ××•×¤×¦×™×” ×¦××—×•× ×™×ª
                        </div>
                        <div class="meal-option-description"><strong>${mealOptions.vegetarian}</strong></div>
                        <button class="meal-option-btn" onclick="showRecipe('vegetarian')">
                            ğŸ‘¨â€ğŸ³ ×”×¦×’ ××ª×›×•×Ÿ
                        </button>
                        <div id="recipe-vegetarian" class="recipe-section" style="display: none; margin-top: 15px;">
                            <div class="recipe-content"></div>
                        </div>
                    </div>
                `;
            }
            
            if (mealOptions.meat) {
                html += `
                    <div class="meal-option-card meat">
                        <div class="meal-option-header">
                            ğŸ¥© ××•×¤×¦×™×” ×‘×©×¨×™×ª
                        </div>
                        <div class="meal-option-description"><strong>${mealOptions.meat}</strong></div>
                        <button class="meal-option-btn" onclick="showRecipe('meat')">
                            ğŸ‘¨â€ğŸ³ ×”×¦×’ ××ª×›×•×Ÿ
                        </button>
                        <div id="recipe-meat" class="recipe-section" style="display: none; margin-top: 15px;">
                            <div class="recipe-content"></div>
                        </div>
                    </div>
                `;
            }
            
            if (mealOptions.fish) {
                html += `
                    <div class="meal-option-card fish">
                        <div class="meal-option-header">
                            ğŸŸ ××•×¤×¦×™×” ×“×’×™×
                        </div>
                        <div class="meal-option-description"><strong>${mealOptions.fish}</strong></div>
                        <button class="meal-option-btn" onclick="showRecipe('fish')">
                            ğŸ‘¨â€ğŸ³ ×”×¦×’ ××ª×›×•×Ÿ
                        </button>
                        <div id="recipe-fish" class="recipe-section" style="display: none; margin-top: 15px;">
                            <div class="recipe-content"></div>
                        </div>
                    </div>
                `;
            }
            
            optionsContainer.innerHTML = html;
        }

        function toggleEditMode() {
            const editSection = document.getElementById('editSection');
            const editBtn = document.getElementById('editBtn');
            
            if (editSection.style.display === 'none') {
                editSection.style.display = 'block';
                editBtn.textContent = 'ğŸ‘ï¸ ×”×¦×’ × ×™×ª×•×—';
            } else {
                editSection.style.display = 'none';
                editBtn.textContent = 'âœï¸ ×¢×¨×•×š × ×™×ª×•×—';
            }
        }

        function cancelEdit() {
            document.getElementById('editSection').style.display = 'none';
            document.getElementById('editBtn').textContent = 'âœï¸ ×¢×¨×•×š × ×™×ª×•×—';
        }

        function saveEdits() {
            const score = document.getElementById('editScore').value;
            const recommendation = document.getElementById('editRecommendation').value;
            const reason = document.getElementById('editReason').value;
            const glycemic = document.getElementById('editGlycemic').value;
            
            // Update display
            const resultsDiv = document.getElementById('analysisResults');
            let html = '<div>';
            
            html += `<div class="score-badge">ğŸ’« ${score}% - × ×™×ª×•×— ××¢×•×“×›×Ÿ</div>`;
            html += `<div class="recommendation">×”×× ×›×“××™ ×œ××›×•×œ: ${recommendation}</div>`;
            html += `<p style="margin: 10px 0; font-size: 1.05rem; line-height: 1.6;"><strong>×¡×™×‘×ª ×”×“×™×¨×•×’:</strong> ${reason}</p>`;
            html += `<p style="margin: 10px 0; font-size: 1.05rem; line-height: 1.6;"><strong>×¢×•××¡ ×’×œ×™×§××™:</strong> ${glycemic}</p>`;
            
            html += '</div>';
            resultsDiv.innerHTML = html;
            
            cancelEdit();
            
            // Show success message
            const successMsg = document.createElement('div');
            successMsg.style.cssText = 'background: #d1fae5; border: 2px solid #10b981; color: #065f46; padding: 15px; border-radius: 10px; margin-top: 15px; text-align: center;';
            successMsg.textContent = 'âœ“ ×”×©×™× ×•×™×™× × ×©××¨×• ×‘×”×¦×œ×—×”!';
            resultsDiv.appendChild(successMsg);
            
            setTimeout(() => successMsg.remove(), 3000);
        }

        function storeDetailedNutrition(analysisText) {
            const detailsDiv = document.getElementById('detailedNutrition');
            const lines = analysisText.split('\n');
            let html = '<div class="details-section">';
            let inNutritionSection = false;
            
            lines.forEach(line => {
                line = line.trim();
                if (line.includes('× ×•×˜×¨×™×× ×˜×™×') || line.includes('×¤×¨××˜×¨×™×')) {
                    inNutritionSection = true;
                    html += `<h4 style="margin: 15px 0; color: var(--primary-dark);">${line}</h4>`;
                } else if (inNutritionSection && line.match(/^-\s*(.+):\s*(.+)$/)) {
                    const match = line.match(/^-\s*(.+?):\s*(.+)$/);
                    if (match) {
                        html += `<div class="detail-row">
                            <span class="detail-label">${match[1]}</span>
                            <span class="detail-value">${match[2]}</span>
                        </div>`;
                    }
                }
            });
            
            html += '</div>';
            detailsDiv.innerHTML = html;
        }

        function toggleNutritionDetails() {
            const detailsDiv = document.getElementById('detailedNutrition');
            detailsDiv.classList.toggle('active');
            
            const btn = event.target;
            if (detailsDiv.classList.contains('active')) {
                btn.textContent = 'ğŸ”¼ ×”×¡×ª×¨ ×¤×¨×˜×™× ×ª×–×•× ×ª×™×™×';
            } else {
                btn.textContent = 'ğŸ“‹ ×”×¦×’ ×¤×¨×˜×™× ×ª×–×•× ×ª×™×™× ××œ××™×';
            }
        }

        async function showRecipe(type) {
            const recipeDiv = document.getElementById(`recipe-${type}`);
            const recipeContent = recipeDiv.querySelector('.recipe-content');
            const btn = event.target;
            
            if (recipeDiv.style.display === 'none') {
                // Show recipe - generate if not already generated
                if (!recipeContent.innerHTML || recipeContent.innerHTML.includes('spinner')) {
                    recipeContent.innerHTML = '<div class="spinner" style="margin: 20px auto;"></div><p style="text-align: center;">××›×™×Ÿ ××ª×›×•×Ÿ ××•×©×œ×...</p>';
                    recipeDiv.style.display = 'block';
                    btn.textContent = 'ğŸ”¼ ×”×¡×ª×¨ ××ª×›×•×Ÿ';
                    
                    let mealDescription = '';
                    if (type === 'vegetarian') mealDescription = mealOptions.vegetarian;
                    else if (type === 'meat') mealDescription = mealOptions.meat;
                    else if (type === 'fish') mealDescription = mealOptions.fish;
                    
                    try {
                        // Call our serverless API for recipe generation
                        const response = await fetch('/api/recipe', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({
                                mealDescription: mealDescription
                            })
                        });

                        const data = await response.json();
                        
                        if (!data.success) {
                            throw new Error(data.error || '×©×’×™××” ×‘×™×¦×™×¨×ª ×”××ª×›×•×Ÿ');
                        }
                        
                        // Format recipe nicely
                        recipeContent.innerHTML = `<div style="white-space: pre-wrap; line-height: 1.8; font-size: 1rem; padding: 15px; background: #f9fafb; border-radius: 8px;">${data.recipe}</div>`;
                        
                    } catch (error) {
                        console.error('Error:', error);
                        recipeContent.innerHTML = '<p style="color: var(--danger);">×©×’×™××” ×‘×˜×¢×™× ×ª ×”××ª×›×•×Ÿ. ×× × × ×¡×” ×©× ×™×ª.</p>';
                    }
                } else {
                    recipeDiv.style.display = 'block';
                    btn.textContent = 'ğŸ”¼ ×”×¡×ª×¨ ××ª×›×•×Ÿ';
                }
            } else {
                recipeDiv.style.display = 'none';
                btn.textContent = 'ğŸ‘¨â€ğŸ³ ×”×¦×’ ××ª×›×•×Ÿ';
            }
        }

        function showLoading() {
            document.getElementById('loadingDiv').classList.add('active');
            document.getElementById('analyzeBtn').disabled = true;
            
            // Disable all inputs during loading
            document.getElementById('mealInput').disabled = true;
            document.getElementById('imageInput').disabled = true;
            document.getElementById('autoDescriptionText').disabled = true;
            
            // Disable tab buttons
            const tabBtns = document.querySelectorAll('.tab-btn');
            tabBtns.forEach(btn => btn.disabled = true);
        }

        function hideLoading() {
            document.getElementById('loadingDiv').classList.remove('active');
            document.getElementById('analyzeBtn').disabled = false;
            
            // Re-enable all inputs
            document.getElementById('mealInput').disabled = false;
            document.getElementById('imageInput').disabled = false;
            document.getElementById('autoDescriptionText').disabled = false;
            
            // Re-enable tab buttons
            const tabBtns = document.querySelectorAll('.tab-btn');
            tabBtns.forEach(btn => btn.disabled = false);
        }

        function showResults() {
            document.getElementById('resultsDiv').classList.add('active');
        }

        function hideResults() {
            document.getElementById('resultsDiv').classList.remove('active');
            document.getElementById('editSection').style.display = 'none';
            document.getElementById('editBtn').style.display = 'none';
            document.getElementById('mealOptions').innerHTML = '';
            document.getElementById('reasoningBox').innerHTML = '';
            document.getElementById('starRatingSection').innerHTML = '';
            document.getElementById('summarySection').innerHTML = '';
            document.getElementById('detailsToggleSection').classList.remove('active');
            document.getElementById('nextMealToggleSection').classList.remove('active');
            document.getElementById('toggleDetailsBtn').style.display = 'none';
            document.getElementById('toggleNextMealBtn').style.display = 'none';
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.classList.add('active');
        }

        function hideError() {
            document.getElementById('errorMessage').classList.remove('active');
        }
    </script>
</body>
</html>